db.movies.aggregate([{ $match: { "imdb.rating": { $gte: 7 } } }, { $match: { $and: [{ genres: { $ne: "Crime" } }, { genres: { $ne: "Horror" } }] } }, { $match: { $or: [{ rated: "PG" }, { rated: "G" }] } }, { $match: { languages: { $all: ["English", "Spanish"] } } }, { $project: { titulo: "$title", _id: 0, avaliado: "$rated", notaIMDB: "$imdb.rating", votosIMDB: "$imdb.votes", ano: "$year" } }, { $sort: { ano: -1, notaIMDB: -1, titulo: 1 } }]);
